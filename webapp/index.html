<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no, user-scalable=no, viewport-fit=cover">
    <title>Maniac Games</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="assets/favicon.png">
    <!-- Telegram WebApp API -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- Tone.js for sound synthesis -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <script>
        // --- Скрипт для предотвращения "вспышки" неправильной темы ---
        (function() {
            const themeKey = 'mg.theme';
            const savedTheme = localStorage.getItem(themeKey) || 'dark'; // Тёмная по умолчанию

            let themeToApply = savedTheme;
            if (savedTheme === 'system') {
                const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                themeToApply = systemPrefersDark ? 'dark' : 'light';
            }

            // Устанавливаем атрибут на body. CSS сделает всё остальное.
            document.documentElement.setAttribute('data-theme', themeToApply);
        })();
    </script>
</head>
<body>
    <!-- Canvas для фоновых частиц. Он будет за всем остальным контентом. -->
    <canvas id="particle-canvas"></canvas>

    <!-- 1. Splash Screen -->
    <div id="splash-screen" class="splash-screen">
        <img src="assets/logo.png" alt="Maniac Stars Logo" class="splash-logo">
        <div class="splash-text">
            Maniac Games
        </div>
    </div>

    <!-- 2. Main App Container -->
    <div id="app" class="app-container hidden">
        <!-- App Header -->
        <header class="app-header">
            <h1 id="header-title"></h1>
            <div class="balance" id="balance-display">
                <span id="balance-value">0</span> ⭐
            </div>
        </header>

        <!-- Main Content Area (views will be injected here) -->
        <main id="main-content" class="main-content">
            <!-- Screen content goes here -->
        </main>

        <!-- Bottom Navigation Bar -->
        <nav id="bottom-nav" class="bottom-nav">
            <!-- Навигация будет сгенерирована в app.js -->
        </nav>
    </div>

    <!-- Main script -->
    <script src="app.js" type="module"></script>
</body>
</html>
